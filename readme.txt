--------------------------------------------------------------------------------
[ソフト名]  PSOBBTools
[著作権者]  s2works (http://s2works.homeunix.net/)
[動作環境]  Microsoft .NET Framework 1.1 がインストールされた Windows2000/XP
[動作確認]  自作PC/AT互換機 (WindowsXP)
[開発環境]  Microsoft Visual Studio .NET 2003 (C#)
--------------------------------------------------------------------------------

■機能
  1. チームチャットで発言があったら音(チャイム)を鳴らす
  2. スクリーンショットを自動でJPEGかPNGに圧縮
  3. マグタイマー
  5. PSOBBのウィンドウにシステムボタン(最小化、最大化、閉じるボタン)を表示
  4. コマンドファイルの実行

  1〜3の説明は不要だと思うんで、しません。
  4はPSOBBのウィンドウに最小化ボタンなどのシステムボタンを表示します。
  5はチームチャットの発言に応じてcommandフォルダにあるコマンドファイルを
  実行します。たとえば、チームチャットで「winamp.play」と発言すれば、
  commandフォルダにあるwinamp.play.csが実行され、Winampで音楽を再生できます。
  フルスクリーンでプレイする人向けの機能です。

■動作環境
  Microsoft .NET Framework 1.1 がインストールされた
  WindowsXP か Windows2000で動くはず。
  9x系は無理。

■使い方
  PSOBBを起動する前に、PSOBBTools.exeを起動してください。
  起動するとアイコンがタスクトレイに表示されます。
  アイコンをダブルクリックするとマグタイマーウィンドウが開きます。
  アイコンを右クリックするとメニューが表示されて設定とかできます。

■設定の説明
・PSOBBのフォルダ
  PSOBBのフォルダ(PsoBB.exe等があるフォルダ)を指定します。
  初期値は"C:\Program Files\SEGA\PHANTASY STAR ONLINE Blue Burst"です。
  PSOBBのインストール先を変更している場合はどうにかしてください。

・ログファイル名(チーム)
  監視対象とするチームチャットのログファイル名を指定します。
  初期値は"GuildChat*.txt"です。
  特に変える必要はありません。

・チームチャットのチャイム
  チームチャットのチャイムの使用を切り替えます。
  True=使用する、False=使用しないです。

・コマンドの使用
  コマンドの使用を切り替えます。
  True=使用する、False=使用しないです。

・SSの自動圧縮
  スクリーンショットの自動圧縮の使用を切り替えます。
  True=使用する、False=使用しないです。

・システムボタンの表示
  システムボタンの表示を切り替えます。
  True=表示する、False=表示しないです。

・チャイム用WAVファイル
  チャイムとして使用するWAVファイルを指定します。
  環境によってはMP3も再生できるかもしれません。

・コマンド許可キャラ名
  コマンドの実行を許可するキャラクター名を指定します。
  たとえば"PSOBB"と設定すると、名前が"PSOBB"のキャラの発言だけが
  コマンドとして認識されます。

・SSのファイル名
  監視対象とするスクリーンショットのファイル名を指定します。
  初期値は"pso*.bmp"です。
  特に変える必要はありません。

・SSの圧縮形式
  スクリーンショットの圧縮形式を指定します。
  JPG、PNGから選択できます。

・マグタイマー用WAVファイル
  マグタイマーの音として使用するWAVファイルを指定します。
  環境によってはMP3も再生できるかもしれません。

・マグタイマーの時間(秒)
  マグタイマーの時間(秒)を指定します。

・マグタイマーの繰り返し
  マグタイマーの繰り返しを指定します。
  True=繰り返す、False=繰り返さないです。

■コマンドファイル
  commandフォルダに入れた*.csファイルがコマンドとして認識されます。
  ファイル名から拡張子を除いた名前がコマンド名となります。
  たとえば、チームチャットで入力するコマンド名を「winamp.play」に
  したい場合はファイル名を「winamp.play.cs」にします。

  コマンドファイルの中身は普通のC#プログラムです。
  PSOBBToolsCommandクラスのMain関数が最初に呼び出されます。
  コンパイルエラーが起こった場合は、ログが「コマンド名.log」として
  出力されます。

■付属コマンドファイルの説明
・hello.world.cs
  サンプルプログラム。
  メッセージボックスで「Hello World using C#!」と表示されるだけ。

・winamp.prev.cs
・winamp.play.cs
・winamp.pause.cs
・winamp.stop.cs
・winamp.next.cs
  Winampを制御する。
  上から順に、Winampの5つのボタンに対応。
  Winamp 5.05で動作確認済み。

・psobb.minimize.cs
  PSOBBのウィンドウを最小化する。
  フルスクリーンモードでやったら落ちるかも。

■既知の問題
・PSOBBの起動後にPSOBBToolsを起動できない
  → 他の .NET Framework を使ったアプリケーションも同様のため、
     PSOBB(というかnProtect)による制限と思われる。
・PSOBBの起動中にPSOBBToolsの設定ウィンドウが開けない
  → PSOBB(というかnProtect)による制限と思われる。
・SSの自動圧縮をオンにしていても圧縮されないことがある
  → 今のところ原因不明。手動でどうにかしてください。
・マグタイマーとPSOBBのマグ餌時間が合わない
  → スペックの低いパソコンで見られる現象。
     時間制限クエの残り時間が各キャラでずれるのと同様に
     マグ餌時間も処理落ちでずれていると思われる。

■履歴
  2005/05/14 ver.1.7
   ・マグタイマーのデフォルト時間を210秒へ変更。
   ・マグタイマーウィンドウのタイトルにカウントを表示。
  2005/05/12 ver.1.6
   ・マグタイマーウィンドウの時間設定をキーボード入力できないように変更。
   ・起動時にシステムボタンの表示設定を適用していなかったのを修正。
  2005/05/12 ver.1.5
   ・マグタイマーを追加。
   ・タスクトレイのアイコンをダブルクリックした時に
     マグタイマーウィンドウを開くように変更。
  2005/05/12 ver.1.4
   ・システムボタンの表示設定を保存するようにした。
   ・タスクトレイのアイコンをダブルクリックした時に
     設定ウィンドウを開くようにした。
  2005/05/11 ver.1.3
   ・設定ウィンドウの項目名を日本語にした。
   ・SSの自動圧縮部分を別スレッド化した。
  2005/03/31 ver.1.2
   ・PSOBBButtonの機能を取り込み、PSOBBのウィンドウにシステムボタンを
     表示できるようにした。
  2004/10/31 ver.1.1
   ・コマンドファイルのコンパイルエラー時にログを出力するようにした。
   ・psobb.minimize.csを追加。
  2004/10/31 ver.1.0
   ・初版。
